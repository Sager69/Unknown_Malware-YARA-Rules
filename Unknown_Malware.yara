import "hash" 

rule malware_detection_strings {
    meta:
        description = "Rule to detect the malware based on specific strings"
        author = "Ali AlNeis and Mohammad Al-Otoum"
        date = "2023-01-10"
    strings:
        $CaesarCipher = "CaesarCipher"
        $intShift = "intShift"
        $PSUTdll = "PSUT.dll is missing!"
        $updator = "C:\\windows\\updator.exe"
        $desktop = "@*\\AC:\\Users\\Haitham\\Desktop\\AAAA\\Project1.vbp"
        $hacked = "C:\\Users\\Hacked.txt"
        $post_handler = "http://www.example.com/post_handler"
        $regkey = "HKEY_CURRENT_USER\\Software\\MyApp\\Key"
        $google = "https://www.google.com"
    condition:
        uint16(0) == 0x5A4D and all of them
}

rule malware_detection_characteristics {
    meta:
        description = "Rule to detect the malware based on specific characteristics like file size, and hashes"
        author = "Ali AlNeis and Mohammad Al-Otoum"
        date = "2023-01-10"
    condition:
        uint16(0) == 0x5A4D and (filesize == 53248) and (hash.md5(0, filesize) == "6147b3df04d5d93d9186f3ede6e74b71") and
        (hash.sha256(0, filesize) == "3c09c7591a85f674b033c17f7d80535963f179b4fcd7fe2aba5f2ec5d6813405")
}